summarize(
mean_rating = mean(Rating),
mean_semester = mean(Semester),
N = n()) |>
arrange(desc(mean_rating))
print(location_stats)
# barplot(location_stats$mean_rating,
#         names.arg = location_stats$Location,
#         ylab = "Mean Rating",
#         main = "Mean Rating per Location",
#         las = 2)
#
#
# barplot(location_stats$mean_semester,
#         names.arg = location_stats$Location,
#         ylab = "Mean Semester",
#         main = "Mean Semester by Location",
#         las = 2)
# What too much GPT does to a script
reason_counts <- filtered_survey %>%
group_by(Location, Reason) %>%
summarise(count = n(), .groups = "drop") %>%
group_by(Location) %>%
mutate(reason_percent = count / sum(count)) %>%
ungroup()
location_summary <- filtered_survey |>
group_by(Location, Reason) |>
summarise(
mean_rating = mean(Rating, na.rm = TRUE),
mean_semester = mean(Semester, na.rm = TRUE),
N = n(),
.groups = "drop"
) |>
arrange(desc(mean_rating))
plot_data <- location_summary %>%
left_join(reason_counts %>% select(Location, Reason, reason_percent),
by = c("Location", "Reason")) %>%
mutate(segment_height = mean_rating * reason_percent)
print(plot_data)
library(forcats)
plot_data <- plot_data %>%
mutate(Location = fct_rev(fct_reorder(Location, segment_height, .fun = sum)))
ggplot(plot_data, aes(x = Location, y = segment_height, fill = Reason)) +
geom_bar(stat = "identity") +
theme_minimal()
ggplot(location_summary, aes(x = Location, y = mean_semester)) +
geom_bar(stat = "identity") +
theme_minimal()
# What too much GPT does to a script
reason_counts <- filtered_survey %>%
group_by(Location, Reason) %>%
summarise(count = n(), .groups = "drop") %>%
group_by(Location) %>%
mutate(reason_percent = count / sum(count)) %>%
ungroup()
location_summary <- filtered_survey |>
group_by(Location, Reason) |>
summarise(
mean_rating = mean(Rating, na.rm = TRUE),
mean_semester = mean(Semester, na.rm = TRUE),
N = n(),
.groups = "drop"
) |>
arrange(desc(mean_rating))
plot_data <- location_summary %>%
left_join(reason_counts %>% select(Location, Reason, reason_percent),
by = c("Location", "Reason")) %>%
mutate(segment_height = mean_rating * reason_percent)
print(plot_data)
library(forcats)
plot_data <- plot_data %>%
mutate(Location = fct_rev(fct_reorder(Location, segment_height, .fun = sum)))
ggplot(plot_data, aes(x = Location, y = segment_height, fill = Reason)) +
geom_bar(stat = "identity") +
theme_minimal()
ggplot(plot_data, aes(x = Location, y = mean_semester)) +
geom_bar(stat = "identity") +
theme_minimal()
semester_rating <- filtered_survey |>
group_by(Semester) |>
summarize(mean_rating = mean(Rating), N = n(), .groups = "drop")
print(semester_rating)
ggplot(semester_rating, aes(x = Semester, y = mean_rating)) +
geom_point(fill = "skyblue") +
geom_smooth(method = "lm", color = "red") +
labs(title = "Mean Rating per Semester with linear trend", y = "Mean Rating", x = "Semester") +
theme_minimal()
# What too much GPT does to a script
reason_counts <- filtered_survey %>%
group_by(Location, Reason) %>%
summarise(count = n(), .groups = "drop") %>%
group_by(Location) %>%
mutate(reason_percent = count / sum(count)) %>%
ungroup()
location_summary <- filtered_survey |>
group_by(Location, Reason) |>
summarise(
mean_rating = mean(Rating, na.rm = TRUE),
mean_semester = mean(Semester, na.rm = TRUE),
N = n(),
.groups = "drop"
) |>
arrange(desc(mean_rating))
plot_data <- location_summary %>%
left_join(reason_counts %>% select(Location, Reason, reason_percent),
by = c("Location", "Reason")) %>%
mutate(segment_height = mean_rating * reason_percent)
print(plot_data)
library(forcats)
plot_data <- plot_data %>%
mutate(Location = fct_rev(fct_reorder(Location, segment_height, .fun = sum)))
ggplot(plot_data, aes(x = Location, y = segment_height, fill = Reason)) +
geom_bar(stat = "identity") +
theme_minimal()
ggplot(location_summary, aes(x = Location, y = mean_semester, fill = Reason)) +
geom_bar(stat = "identity") +
theme_minimal()
location_stats <- filtered_survey |>
group_by(Location) |>
summarize(
mean_rating = mean(Rating),
mean_semester = mean(Semester),
N = n()) |>
arrange(desc(mean_rating))
barplot(location_stats$mean_semester,
names.arg = location_stats$Location,
ylab = "Mean Semester",
main = "Mean Semester by Location",
las = 2)
# What too much GPT does to a script
reason_counts <- filtered_survey %>%
group_by(Location, Reason) %>%
summarise(count = n(), .groups = "drop") %>%
group_by(Location) %>%
mutate(reason_percent = count / sum(count)) %>%
ungroup()
location_summary <- filtered_survey |>
group_by(Location, Reason) |>
summarise(
mean_rating = mean(Rating, na.rm = TRUE),
mean_semester = mean(Semester, na.rm = TRUE),
N = n(),
.groups = "drop"
) |>
arrange(desc(mean_rating))
plot_data <- location_summary %>%
left_join(reason_counts %>% select(Location, Reason, reason_percent),
by = c("Location", "Reason")) %>%
mutate(segment_height = mean_rating * reason_percent)
print(plot_data)
library(forcats)
plot_data <- plot_data %>%
mutate(Location = fct_rev(fct_reorder(Location, segment_height, .fun = sum)))
ggplot(plot_data, aes(x = Location, y = segment_height, fill = Reason)) +
geom_bar(stat = "identity") +
theme_minimal()
location_stats <- filtered_survey |>
group_by(Location) |>
summarize(
mean_rating = mean(Rating),
mean_semester = mean(Semester),
N = n()) |>
arrange(desc(mean_rating))
barplot(location_stats$mean_semester,
names.arg = location_stats$Location,
ylab = "Mean Semester",
main = "Mean Semester by Location",
las = 2)
# What too much GPT does to a script
reason_counts <- filtered_survey %>%
group_by(Location, Reason) %>%
summarise(count = n(), .groups = "drop") %>%
group_by(Location) %>%
mutate(reason_percent = count / sum(count)) %>%
ungroup()
location_summary <- filtered_survey |>
group_by(Location, Reason) |>
summarise(
mean_rating = mean(Rating, na.rm = TRUE),
mean_semester = mean(Semester, na.rm = TRUE),
N = n(),
.groups = "drop"
) |>
arrange(desc(mean_rating))
plot_data <- location_summary %>%
left_join(reason_counts %>% select(Location, Reason, reason_percent),
by = c("Location", "Reason")) %>%
mutate(segment_height = mean_rating * reason_percent)
print(plot_data)
library(forcats)
plot_data <- plot_data %>%
mutate(Location = fct_rev(fct_reorder(Location, segment_height, .fun = sum)))
ggplot(plot_data, aes(x = Location, y = segment_height, fill = Reason)) +
geom_bar(stat = "identity") +
theme_minimal() +
labs(
title = "Mean Ratings per Location with Reasons",
x = "Location",
y = "Mean Rating",
fill = "Reason"
)
# not coloring the bars is significantly simpler
location_stats <- filtered_survey |>
group_by(Location) |>
summarize(
mean_rating = mean(Rating),
mean_semester = mean(Semester),
N = n()) |>
arrange(desc(mean_rating))
barplot(location_stats$mean_semester,
names.arg = location_stats$Location,
ylab = "Mean Semester",
main = "Mean Semester by Location",
las = 2)
# What too much GPT does to a script
reason_counts <- filtered_survey %>%
group_by(Location, Reason) %>%
summarise(count = n(), .groups = "drop") %>%
group_by(Location) %>%
mutate(reason_percent = count / sum(count)) %>%
ungroup()
location_summary <- filtered_survey |>
group_by(Location, Reason) |>
summarise(
mean_rating = mean(Rating, na.rm = TRUE),
mean_semester = mean(Semester, na.rm = TRUE),
N = n(),
.groups = "drop"
) |>
arrange(desc(mean_rating))
plot_data <- location_summary %>%
left_join(reason_counts %>% select(Location, Reason, reason_percent),
by = c("Location", "Reason")) %>%
mutate(segment_height = mean_rating * reason_percent)
print(plot_data)
library(forcats)
plot_data <- plot_data %>%
mutate(Location = fct_rev(fct_reorder(Location, segment_height, .fun = sum)))
ggplot(plot_data, aes(x = Location, y = segment_height, fill = Reason)) +
geom_bar(stat = "identity") +
theme_minimal() +
scale_fill_manual(
labels = c("Q" = "Quality", "C" = "Convenience", "P" = "Price")
) +
labs(
title = "Mean Ratings per Location with Reasons",
x = "Location",
y = "Mean Rating",
fill = "Reason"
)
# What too much GPT does to a script
reason_counts <- filtered_survey %>%
group_by(Location, Reason) %>%
summarise(count = n(), .groups = "drop") %>%
group_by(Location) %>%
mutate(reason_percent = count / sum(count)) %>%
ungroup()
location_summary <- filtered_survey |>
group_by(Location, Reason) |>
summarise(
mean_rating = mean(Rating, na.rm = TRUE),
mean_semester = mean(Semester, na.rm = TRUE),
N = n(),
.groups = "drop"
) |>
arrange(desc(mean_rating))
plot_data <- location_summary %>%
left_join(reason_counts %>% select(Location, Reason, reason_percent),
by = c("Location", "Reason")) %>%
mutate(segment_height = mean_rating * reason_percent)
print(plot_data)
library(forcats)
plot_data <- plot_data %>%
mutate(Location = fct_rev(fct_reorder(Location, segment_height, .fun = sum)))
ggplot(plot_data, aes(x = Location, y = segment_height, fill = Reason)) +
geom_bar(stat = "identity") +
theme_minimal() +
scale_fill_manual(
values = c("Q" = "#1b9e77", "C" = "#d95f02", "P" = "#7570b3"),
labels = c("Q" = "Quality", "C" = "Convenience", "P" = "Price")
) +
labs(
title = "Mean Ratings per Location with Reasons",
x = "Location",
y = "Mean Rating",
fill = "Reason"
)
# not coloring the bars is significantly simpler
location_stats <- filtered_survey |>
group_by(Location) |>
summarize(
mean_rating = mean(Rating),
mean_semester = mean(Semester),
N = n()) |>
arrange(desc(mean_rating))
barplot(location_stats$mean_semester,
names.arg = location_stats$Location,
ylab = "Mean Semester",
main = "Mean Semester by Location",
las = 2)
# What too much GPT does to a script
reason_counts <- filtered_survey %>%
group_by(Location, Reason) %>%
summarise(count = n(), .groups = "drop") %>%
group_by(Location) %>%
mutate(reason_percent = count / sum(count)) %>%
ungroup()
location_summary <- filtered_survey |>
group_by(Location, Reason) |>
summarise(
mean_rating = mean(Rating, na.rm = TRUE),
mean_semester = mean(Semester, na.rm = TRUE),
N = n(),
.groups = "drop"
) |>
arrange(desc(mean_rating))
plot_data <- location_summary %>%
left_join(reason_counts %>% select(Location, Reason, reason_percent),
by = c("Location", "Reason")) %>%
mutate(segment_height = mean_rating * reason_percent)
print(plot_data)
library(forcats)
plot_data <- plot_data %>%
mutate(Location = fct_rev(fct_reorder(Location, segment_height, .fun = sum)))
ggplot(plot_data, aes(x = Location, y = segment_height, fill = Reason)) +
geom_bar(stat = "identity") +
theme_minimal() +
scale_fill_manual(
values = c("Q" = "#1b9e77", "C" = "#d95f02", "P" = "#7570b3"),
labels = c("Q" = "Quality", "C" = "Convenience", "P" = "Price")
) +
labs(
title = "Mean Ratings per Location with Reasons",
x = "Location",
y = "Mean Rating",
fill = "Reason in %"
)
# not coloring the bars is significantly simpler
location_stats <- filtered_survey |>
group_by(Location) |>
summarize(
mean_rating = mean(Rating),
mean_semester = mean(Semester),
N = n()) |>
arrange(desc(mean_rating))
barplot(location_stats$mean_semester,
names.arg = location_stats$Location,
ylab = "Mean Semester",
main = "Mean Semester by Location",
las = 2)
# What too much GPT does to a script
reason_counts <- filtered_survey %>%
group_by(Location, Reason) %>%
summarise(count = n(), .groups = "drop") %>%
group_by(Location) %>%
mutate(reason_percent = count / sum(count)) %>%
ungroup()
location_summary <- filtered_survey |>
group_by(Location, Reason) |>
summarise(
mean_rating = mean(Rating, na.rm = TRUE),
mean_semester = mean(Semester, na.rm = TRUE),
N = n(),
.groups = "drop"
) |>
arrange(desc(mean_rating))
plot_data <- location_summary %>%
left_join(reason_counts %>% select(Location, Reason, reason_percent),
by = c("Location", "Reason")) %>%
mutate(segment_height = mean_rating * reason_percent)
print(plot_data)
library(forcats)
plot_data <- plot_data %>%
mutate(Location = fct_rev(fct_reorder(Location, segment_height, .fun = sum)))
ggplot(plot_data, aes(x = Location, y = segment_height, fill = Reason)) +
geom_bar(stat = "identity") +
theme_minimal() +
geom_text(aes(label = N),                      # use N as label
position = position_stack(vjust = 0.5),
size = 3,
color = "white") +
scale_fill_manual(
values = c("Q" = "#1b9e77", "C" = "#d95f02", "P" = "#7570b3"),
labels = c("Q" = "Quality", "C" = "Convenience", "P" = "Price")
) +
labs(
title = "Mean Ratings per Location with Reasons",
x = "Location",
y = "Mean Rating",
fill = "Reason in %"
)
# not coloring the bars is significantly simpler
location_stats <- filtered_survey |>
group_by(Location) |>
summarize(
mean_rating = mean(Rating),
mean_semester = mean(Semester),
N = n()) |>
arrange(desc(mean_rating))
barplot(location_stats$mean_semester,
names.arg = location_stats$Location,
ylab = "Mean Semester",
main = "Mean Semester by Location",
las = 2)
# What too much GPT does to a script
reason_counts <- filtered_survey %>%
group_by(Location, Reason) %>%
summarise(count = n(), .groups = "drop") %>%
group_by(Location) %>%
mutate(reason_percent = count / sum(count)) %>%
ungroup()
location_summary <- filtered_survey |>
group_by(Location, Reason) |>
summarise(
mean_rating = mean(Rating, na.rm = TRUE),
mean_semester = mean(Semester, na.rm = TRUE),
N = n(),
.groups = "drop"
) |>
arrange(desc(mean_rating))
plot_data <- location_summary %>%
left_join(reason_counts %>% select(Location, Reason, reason_percent),
by = c("Location", "Reason")) %>%
mutate(segment_height = mean_rating * reason_percent)
print(plot_data)
library(forcats)
plot_data <- plot_data %>%
mutate(Location = fct_rev(fct_reorder(Location, segment_height, .fun = sum)))
ggplot(plot_data, aes(x = Location, y = segment_height, fill = Reason)) +
geom_bar(stat = "identity") +
theme_minimal() +
geom_text(aes(label = N),                      # use N as label
position = position_stack(vjust = 0.5),
size = 3,
color = "white") +
scale_fill_manual(
values = c("Q" = "#1b9e77", "C" = "#d95f02", "P" = "#7570b3"),
labels = c("Q" = "Quality", "C" = "Convenience", "P" = "Price")
) +
labs(
title = "Mean Ratings per Location with Reasons",
x = "Location",
y = "Mean Rating",
fill = "Reason in % \n with N answers"
)
# not coloring the bars is significantly simpler
location_stats <- filtered_survey |>
group_by(Location) |>
summarize(
mean_rating = mean(Rating),
mean_semester = mean(Semester),
N = n()) |>
arrange(desc(mean_rating))
barplot(location_stats$mean_semester,
names.arg = location_stats$Location,
ylab = "Mean Semester",
main = "Mean Semester by Location",
las = 2)
# What too much GPT does to a script
reason_counts <- filtered_survey %>%
group_by(Location, Reason) %>%
summarise(count = n(), .groups = "drop") %>%
group_by(Location) %>%
mutate(reason_percent = count / sum(count)) %>%
ungroup()
location_summary <- filtered_survey |>
group_by(Location, Reason) |>
summarise(
mean_rating = mean(Rating, na.rm = TRUE),
mean_semester = mean(Semester, na.rm = TRUE),
N = n(),
.groups = "drop"
) |>
arrange(desc(mean_rating))
plot_data <- location_summary %>%
left_join(reason_counts %>% select(Location, Reason, reason_percent),
by = c("Location", "Reason")) %>%
mutate(segment_height = mean_rating * reason_percent)
print(plot_data)
library(forcats)
plot_data <- plot_data %>%
mutate(Location = fct_rev(fct_reorder(Location, segment_height, .fun = sum)))
ggplot(plot_data, aes(x = Location, y = segment_height, fill = Reason)) +
geom_bar(stat = "identity") +
theme_minimal() +
geom_text(aes(label = N),                      # use N as label
position = position_stack(vjust = 0.5),
size = 3,
color = "white") +
scale_fill_manual(
values = c("Q" = "#1b9e77", "C" = "#d95f02", "P" = "#7570b3"),
labels = c("Q" = "Quality", "C" = "Convenience", "P" = "Price")
) +
labs(
title = "Mean Ratings per Location with Reasons",
x = "Location",
y = "Mean Rating",
fill = "Reason in % \nwith N answers"
)
# not coloring the bars is significantly simpler
location_stats <- filtered_survey |>
group_by(Location) |>
summarize(
mean_rating = mean(Rating),
mean_semester = mean(Semester),
N = n()) |>
arrange(desc(mean_rating))
barplot(location_stats$mean_semester,
names.arg = location_stats$Location,
ylab = "Mean Semester",
main = "Mean Semester by Location",
las = 2)
